/*!
 * @form-create/component-arco-upload v3.1.30
 * (c) 2018-2024 xaboy
 * Github https://github.com/xaboy/form-create with upload
 * Released under the MIT License.
 */
import{defineComponent as e,createVNode as i,Fragment as t,resolveComponent as s,mergeProps as l}from"vue";const r=function(e,i){return{url:e,name:a(e),status:"done",uid:i+1}},a=function(e){return(""+e).split("/").pop()},u=function(e){return{url:e.url,file:e}};var n=e({name:"fcUpload",inheritAttrs:!1,formCreateParser:{toFormValue:e=>function(e){return Array.isArray(e)?e:[null,void 0,""].indexOf(e)>-1?[]:[e]}(e),toValue:(e,i)=>1===i.prop.props.limit?e[0]||"":e},props:{modelValue:{type:Array,default:()=>[]},onSuccess:{type:Function,required:!0},onPreview:Function,modalTitle:String,previewMask:void 0},emits:["update:modelValue","success","fc.el"],data(){return{previewImage:"",previewVisible:!1,uploadList:this.modelValue.map(r).map(u)}},watch:{modelValue(e){this.uploadList=e.map(r).map(u)}},methods:{handleChange(e){this.onSuccess(...arguments);const i=this.uploadList;e.url&&i.push({url:e.url,file:e}),this.input(i)},input(e){this.$emit("update:modelValue",e.map((e=>e.url)))},inputRemove(e){e.length<this.uploadList.length&&this.input(e)},handlePreview(e){this.onPreview?this.onPreview(...arguments):(this.previewImage=e.url,this.previewVisible=!0)}},render(){return i(t,null,[i(s("AUpload"),l({"list-type":"picture-card"},this.$attrs,{onPreview:this.handlePreview,onSuccess:this.handleChange,ref:"upload",fileList:this.uploadList,"onUpdate:fileList":this.inputRemove}),this.$slots),i(s("aModal"),{mask:this.previewMask,title:this.modalTitle,visible:this.previewVisible,onCancel:()=>this.previewVisible=!1,footer:null},{default:()=>[i("img",{style:"width: 100%",src:this.previewImage},null)]})])},mounted(){this.$emit("fc.el",this.$refs.upload)}});export{n as default};
