/*!
 * @form-create/component-antdv-upload v3.1.30
 * (c) 2018-2024 xaboy
 * Github https://github.com/xaboy/form-create with upload
 * Released under the MIT License.
 */
import{openBlock as e,createElementBlock as t,createElementVNode as i,defineComponent as l,resolveComponent as s,createVNode as r,Fragment as a,mergeProps as n}from"vue";var o={name:"PlusOutlined"};const u={class:"anticon"},d=[i("svg",{height:"1em",width:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[i("defs"),i("path",{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z",fill:"currentColor"}),i("path",{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z",fill:"currentColor"})],-1)];o.render=function(i,l,s,r,a,n){return e(),t("span",u,d)};const p=function(e,t){return{url:e,name:h(e),status:"done",uid:-1*(t+1)}},h=function(e){return(""+e).split("/").pop()},m=function(e){return{url:e.url,file:e,uid:e.uid}};var c=l({name:"fcUpload",inheritAttrs:!1,formCreateParser:{toFormValue:e=>function(e){return Array.isArray(e)?e:[null,void 0,""].indexOf(e)>-1?[]:[e]}(e),toValue:(e,t)=>1===t.prop.props.limit?e[0]||"":e},props:{limit:{type:Number,default:0},modelValue:{type:Array,default:()=>[]},onSuccess:{type:Function,required:!0},onPreview:Function,modalTitle:String,previewMask:void 0},emits:["update:modelValue","change","fc.el"],data(){return{previewImage:"",previewVisible:!1,uploadList:this.modelValue.map(p).map(m)}},watch:{modelValue(e){this.uploadList=e.map(p).map(m)}},methods:{handlePreview(e){this.onPreview?this.onPreview(...arguments):(this.previewImage=e.url,this.previewVisible=!0)},handleChange({file:e,fileList:t}){this.$emit("change",...arguments),this.uploadList=t,"done"===e.status?(this.onSuccess(e,t),this.input()):"removed"===e.status&&(t.forEach(((i,l)=>{i.file===e&&t.splice(l,1)})),this.input())},input(){this.$emit("update:modelValue",this.uploadList.map((e=>e.url)))}},render(){var e,t;const i=!this.limit||this.limit>this.uploadList.length,l=s("AModal"),u={[l.props.open?"open":"visible"]:this.previewVisible};return r(a,null,[r(s("AUpload"),n({maxCount:this.limit,"list-type":"picture-card"},this.$attrs,{onPreview:this.handlePreview,onChange:this.handleChange,fileList:this.uploadList,ref:"upload"}),{default:()=>[i?(null===(e=(t=this.$slots).default)||void 0===e?void 0:e.call(t))||r(o,{style:"font-size: 16px; width: 16px;"},null):null],...(d=this.$slots,p=["default"],Object.keys(d).reduce(((e,t)=>(p&&-1!==p.indexOf(t)||e.push(d[t]),e)),[]))}),r(l,n({mask:this.previewMask,title:this.modalTitle},u,{onCancel:()=>this.previewVisible=!1,footer:null}),{default:()=>[r("img",{style:"width: 100%",src:this.previewImage},null)]})]);var d,p},mounted(){this.$emit("fc.el",this.$refs.upload)}});export{c as default};
